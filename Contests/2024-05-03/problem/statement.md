<div align='center'><font size='15'> OIFHA联合训练</font></div><div align='center'>

# 题目概览

| 中文题目名称 | 因为我已触碰过天空 | 命运从未公平   | 使一颗心免于哀伤 | 星间旅行   |
| ------------ | ------------------ | :------------- | ---------------- | ---------- |
| 英文题目名称 | sky                | Aventurine     | firefly          | travel     |
| 可执行文件名 | sky                | Aventurine     | firefly          | travel     |
| 输入文件名   | sky.in             | Aventurine.in  | firefly.in       | travel.in  |
| 输出文件名   | sky.out            | Aventurine.out | firefly.out      | travel.out |
| 时间限制     | 1.0秒              | 0.5秒          | 1.0秒            | 2.5秒      |
| 空间限制     | 512MB              | 512MB          | 512MB            | 512MB      |
| 测试点数目   | 10                 | 20             | 10               | 10         |
| 测试点分值   | 10                 | 5              | 10               | 10         |
| 题目类型     | 传统               | 传统           | 传统             | 传统       |
| 比较方式     | 全文比较           | 全文比较       | 全文比较         | 全文比较   |
| 是否有部分分 | 是                 | 是             | 是               | 是         |

注意事项：

$1.$ 文件名（程序名和输入输出文件名）必须使用小写。

$2.$ C/C++中函数main()的返回值类型必须是int，程序正常结束时的返回值必须是0。

$3.$ 评测环境为Linux，使用lemonlime进行评测。

$4.$ 选手不得使用SSH等命令。

$5.$ 选手不得使用内嵌汇编，#pragma等指令。

$6.$ 评测时使用 C++14 环境，同时开启 O2 优化，栈空间和内存限制相同。

**$7.$​ 本场比赛所有题目均有形式化题意，选手可直接阅读**

# 因为我已触碰过天空（sky）

### 【题目背景】

![](https://cdn.luogu.com.cn/upload/image_hosting/csrrn5wd.png)

$ \begin{aligned} &\text{「因为我已触碰过天空，所以我无法放弃飞翔」} \\&\text{「因为我已触碰过天空，所以我将要继续飞翔」}\\&\text{「因为我已触碰过天空，所以我不会再次飞翔」}\end{aligned}$ 

但我对你的爱，会飘落在世界的每个角落

### 【题目描述】

$\text{Dawn}$ 过完《我已触碰过天空》后感触万千，发动宇宙射线的能力让自己魂穿采翼战死前，迎面遇上 $t$ 只丰饶孽物。

通过开挂，$\text{Dawn}$ 发现丰饶孽物有 $x$ 滴血，并且丰饶孽物有强大的恢复能力，可在使用任意次 [永寿] ，**使自己的血量变为原来的 $d$ 倍**。

$\text{Dawn}$ 打算利用宇宙射线的秩序之力对付它，每次宇宙射线可使其**血量变为自身十进制下各数位数之和**

可惜丰饶孽物实在太能活，$\text{Dawn}$ 只能尽量压低他的血量。

而由于魂穿让 $\text{Dawn}$ 使用了太多宇宙射线的力量，小 $\text{Dawn}$ 打算在将其血量压到最低的前提下使得双方操作次数之和尽量小。

由于小 $\text{Dawn}$ 疲于战斗，所以他希望让同为 OIer 的你写个程序告知他结果，即血量最低压到多少，在此基础上双方最少操作多少次。

### 【形式化题意】

有 $t$ 组询问。

初始给你一个数 $x$。

我们称任意时刻 $x$ 的十进制表示为 $\sum_{i=0}\limits{num_i \times 10^i}$。

你可以执行任意次操作使 $x = dx$ 或 $x = \sum_{i=0}\limits{num_i}$。

问 $x$ 最小可变成多少，在此基础上最少做多少次操作。

### 【输入格式】

从文件 ```sky.in```读入。

第一行一个整数 $T$ （$1 \le T \le 10^4$），表示数据组数。

### 【输出格式】

输出到文件 `sky.out`。

输出 $T$ 行，每行两个整数，分别表示最低的血量以及操作的次数。

### 【样例输入 #1】

```
3
125 8
40 5
872711455340394784 1
```

### 【样例输出 #1】

```
1 2
1 3
1 3
```

### 【样例解释】

对于第一组询问，将 $125$ 乘上 $8$，得 $1000$。然后，取 $1000$ 的数位和，得 $1$。

对于第二组询问，将 $40$ 乘上 $5$，得 $200$。将 $200$ 再乘上 $5$，得 $1000$。取 $1000$ 的数位和，得 $1$。

对于第三组询问，取其数位和，得 $82$。取其数位和，得 $10$。再取其数位和，得 $1$。

### 【子任务】

对于 $100\%$ 的数据：$1 \le t \le 10^4$，$1 \le x \le 10^{18}, 1 \le d \le 100$

| 数据编号  | $T$      | $x$            |    $d$     |
| :-------: | -------- | -------------- | :--------: |
|    $1$    | $=530$   | $\leq 10^{18}$ |    $=1$    |
| $2\sim3$  | $=530$   | $\leq 100$     | $\leq 10$  |
| $4\sim6$  | $=1019$  | $\leq 10^9$    | $\leq 10$  |
| $7\sim10$ | $=10000$ | $\leq 10^{18}$ | $\leq 100$ |

# 命运从未公平（Aventurine）

### 【题目背景】

![](https://cdn.luogu.com.cn/upload/image_hosting/wseglwyb.png)

$ \begin{aligned} &\text{「愿母神三度为你阖眼」} \\&\text{「令你的血脉永远鼓动」}\\&\text{「旅途永远坦然」}\\&\text{「诡计永不败露」}\end{aligned}$

欢迎来到这个悲伤的世界，卡卡瓦夏。

### 【题目描述】



 $\text{Dawn}$ 不可避免的被这个天鹅绒里的恶魔深深吸引。

崇拜一个人最好的方式就是击败他，$ \text{Dawn} $ 决定走上赌桌与砂金来一场别样的赌局。

桌上摆着两副同样的特殊扑克，每张牌刻着三个数 $(a_i,b_i,c_i)$。

牌手需要从中选出一组手牌 $S$，并且付出 $\sum_{i\in S}{b_i} \times \sum_{i \in T}c_i$ 枚筹码。

同时，桌上还有两排编号为 $0\sim 2^{26}$ 的星琼

若能够从牌手的手牌中组出一组牌 $T$（可以空出） ，使其 $\bigoplus_{i\in T} a_i =x$（其中 $\oplus$ 表示异或运算），则可以赢得第 $x$ 颗星琼。

若牌手得到的星琼比对方多，抑或相同星琼情况下支付的筹码更少，则赢得胜利。

卡卡瓦夏是被母神赐福之人，好运总是站在他那边，他不假思索的选择便成功赢得了最多的星琼。

人不可能一辈子只做正确的决定， $\text{Dawn}$ 敏锐的发现砂金在支付的筹码数上并不是最优选择。

可惜赌场不准带电脑，只能由同为 OIer 的你写个程序告知他结果，即在赢得最多星琼的情况下，最少支付多少筹码。

### 【形式化题意】

定义一个可重集 $S$ 的生成元 $x$，当且仅当存在子集 $T$ 使得其所有元素异或和为 $x$（注：$T$ 可以为 $S$ 或 $\phi$）

定义可重集 $S$ 的价值为 $S$ 的生成元种类数。

有 $T$ 组询问。

每组给出 $n$ 个三元组 $(a_i,b_i,c_i)$。

你需要选择一个集合 $T$，所有 $a_{i\in T}$ 构成可重集 $S$，选择 $T$ 的代价为 $\sum_{i\in T}{b_i} \times \sum_{i \in T}c_i$。

请求出使得 $S$ 价值最大所花费的最小代价。

### 【输入格式】

从文件 ```Aventurine.in```读入。

第一行一个整数 $T$（$1 \le T \le 10^3$）。

对于每组数据，首先有一行一个整数 $n$ 表示三元组数量。

接下来 $n$ 行，每行三个非负整数 $a_i, b_i,c_i$ 描述一个三元组。

### 【输出格式】

输出到文件 `Aventurine.out`。

输出 $T$ 行，依次表示每组数据的最小代价。

### 【样例输入 #1】

```
2
2
1 3 7
2 5 2
3
1 2 6
2 4 4
3 6 2
```

### 【样例输出 #1】

```
72
60
```

### 【样例解释】

对于第一组数据：

选择空集可以生成的数为 $0$，价值为 $1$，代价为 $0$。

选择一个元素，价值均为 $2$，代价分别为 $21,10$。

选择两个元素，可以生成 $0,1,2,3$ ，价值为 $4$，代价为 $72$。

因此答案为 $72$。

对于第二组数据，选择任意两个元素均可生成 $0,1,2,3$ ，选择三个元素也只能生成 $0,1,2,3$。

因此最优方案为选择 $\{1,2\}$ 或者 $\{2,3\}$ ，代价均为 $60$。

### 【样例输入 #2】

```
2
7
1 5 9
2 9 2
3 9 7
4 6 8
5 8 4
6 6 1
7 4 3
7
1 3 2
2 4 5
3 7 4
4 1 7
5 7 2
6 3 6
7 8 4
```

### 【样例输出 #2】

```
114
105
```

### 【样例 #3 $\sim$ 5】

见下发文件

### 【子任务】

对于 $100\%$ 的数据，保证 $T \leq 1019$，$1\leq n \leq 10^3$，$\sum{n^2}\leq 3 \times 10^6$，$1 \leq a_i,b_i,c_i < 2^{25}$。

保证每组数据的答案不超过 $10^{18}$

|  数据编号   | $特殊限制$                                                   |
| :---------: | ------------------------------------------------------------ |
|     $1$     | $T=0$                                                        |
|  $2\sim4$   | $T\leq 10$，$n \leq 10$                                      |
|  $5\sim7$   | $T \leq 10$，$n \leq 16$                                     |
|  $8\sim9$   | $b_i=1$，$n \leq 100$，$\sum{n^2} \leq 7.5 \times 10^4$      |
| $10\sim12$  | $1\leq b_i \leq 2$，$n \leq 100$，$\sum{n^2} \leq 7.5 \times 10^4$ |
| $13\sim15$  | $n\leq 30$，$\sum{n^2} \leq 10^4$                            |
| $16 \sim18$ | $n \leq 100$，$\sum{n^2}\leq 7.5 \times 10^4$                |
| $19\sim20$  | $\text{无特殊限制}$                                          |

# 使一颗心免于哀伤（firefly）

### 【题目背景】

![](https://cdn.luogu.com.cn/upload/image_hosting/f47k54ix.png)

$ \begin{aligned} &\text{「 Let me heart bravely spread the wings」} \\&\text{「Soaring past the night」}\\&\text{「To trace the bright moonlight」}\\&\text{「Let the clouds heal me of the stings」}\\&\text{「Gently wipe the sorrow of my life」}\\&\text{「I dream」}\end{aligned}$

在灯红酒绿的海洋里，善意如萤火般难寻。

你我只相隔小小的玻璃，何时可以打碎拥抱你呢。

### 【题目描述】

众所周知 $\text{Dawn}$ 是买礼物大师。

$\text{Dawn}$ 正在准备给流萤的第 $114514$ 天 纪念日礼物，但 $\text{Dawn}$ 发现他的口袋又没钱了！

由于不给流萤礼物可能被萨姆当场火化，善于买礼物的 $\text{Dawn}$ 决定认真~~（随手）~~画一张图送给流萤。

$\text{Dawn}$ 认为 流萤是 「无瑕之人」，所以他希望知道送给流萤的图中 $K_n$ 子图有多少个。

（Tips：$K_n$ 图意为有 $n$ 个点的完全图，不同的 $K_n$ 子图当且仅当其点集 $G$ 不同，保证图无自环。）

### 【形式化题意】

给定 $n$ 个点 $m$ 条边的无向图 $G$，询问其 $K_t$ 子图的数量（ $1\leq t\leq4$ ）。

（Tips：$K_n$ 图意为有 $n$ 个点的完全图，不同的 $K_n$ 子图当且仅当其点集 $G$ 不同，保证图无自环。）

### 【输入格式】

从文件 ```firefly.in```读入。

第一行三个正整数 $n$，$m$ 和 $t$ 。

接下来 $m$ 行，每行两个正整数 $u$ 和 $v$ ，表示 $u$ 和 $v$ 之间有一条边。

### 【输出格式】

输出到文件 `firefly.out`。

输出一行一个整数表示答案。

### 【样例输入 #1】

```
5 9 4
1 2
1 3
1 4
1 5
2 3
2 4
2 5
3 4
3 5
```

### 【样例输出 #1】

```
2
```

### 【样例 #2 $\sim$ 4】

见下发文件

### 【子任务】

对于 $100\%$ 的数据，保证 $4 \leq n \leq 10^5$，$0\leq m \leq 10^5$，$1\leq t \leq 4$

|  数据编号  | $特殊限制$          |
| :--------: | ------------------- |
|    $1$     | $m=0$               |
|    $2$     | $t \leq 2$          |
|    $3$     | $n \leq 100, t = 3$ |
| $4\sim 5$  | $n \leq 100,t=4$    |
|  $6\sim7$  | $t=3$               |
| $8\sim 10$ | $\text{无特殊性质}$ |

# 星间旅行（travel）

![](https://cdn.luogu.com.cn/upload/image_hosting/z5og9ayq.png)

### 【题目背景】

$ \begin{aligned} &\text{「One ! Stop staying within the lines」} \\&\text{「Two ! We always align」}\\&\text{「Three ! Even if we don't gain the upper hand, we'll fight for right」}\\&\text{「Four ! Never care a rap for hindsight」}\\&\text{「Five ! Let us light the night」}\\&\text{「Six ! Even when there are wheels within wheels, go ahead」}\end{aligned}$

Put yesterdays aside

Meet the future head-on

### 【题目描述】

不知不觉，$\text{Dawn}$ 的「开拓」之旅已经一年了，他也该返回现实世界继续「开拓」了。

列车长帕姆十分不舍，锁上了列车的车门，需要解开一道谜题才能打开。

帕姆写下了一个长度为 $n$ 的非负序列 $a$，但由于帕姆写几个字就得写帕，于是他用元素 $1$ 代替了帕。

令 $S = \sum a_i$，帕姆至少在 $a$ 中写下了 $\lceil\frac{1}{5}S\rceil$ 个 $1$

帕姆告诉 $\text{Dawn}$，密码是序列中长度不同或元素和不同的子序列个数。

请你帮助 $\text{Dawn}$ 重返现世，开启新的开拓之旅帕！

### 【形式化题意】

给定一个长度为 $n$ 的非负序列 $a$，求其本质不同的子序列个数。

定义两个序列为本质不同的，当且仅当两个序列长度不同，或所有元素之和不同。

令 $S = \sum a_i$，**保证 $a$ 中至少有 $\lceil\frac{1}{5}S\rceil$ 个元素为 $1$**

空子序列被计入答案。

### 【输入格式】

从文件 ```travel.in```读入。

第一行两个整数 $n$，$S$。

接下来一行 $n$ 个数，表示序列 $a_i$

### 【输出格式】

输出到文件 `travel.out`。

输出一行一个整数表示答案。

### 【样例输入 #1】

```
7 9
0 0 0 1 1 2 5
```

### 【样例输出 #1】

```
42
```

### 【样例输入 #2】

```
10 14
3 5 3 0 1 0 1 0 1 0
```

### 【样例输出 #2】

````
87
````

### 【子任务】

对于 $100\%$ 的数据，保证 $1 \leq n,S \leq 2\times10^5$，$a_i \geq 0$， $a$ 中至少有 $\lceil\frac{1}{5}S\rceil$ 个元素为 $1$

| 数据编号  | $特殊限制$                             |
| :-------: | -------------------------------------- |
|    $1$    | $n\leq20$                              |
|    $2$    | $n \leq 300$                           |
|     3     | $n \leq 10^4$                          |
| $4\sim5$  | $n \leq 10^5$，$a_i=1$ 或 $cnt(a_i)=1$ |
| $6\sim7$  | $n\leq 10^5$                           |
| $8\sim10$ | $\text{无特殊性质}$                    |