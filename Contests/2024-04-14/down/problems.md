<div align='center'><font size='15'> OIFHA联合训练第九场</font></div>

一、题目概览

| 中文题目名称 | 大魔法师  | 黑洞          | 任务安排 | 游乐园   |
| ------------ | --------- | :------------ | -------- | -------- |
| 英文题目名称 | magic     | blackhole     | task     | game     |
| 可执行文件名 | magic     | blackhole     | task     | game     |
| 输入文件名   | magic.in  | blackhole.in  | task.in  | game.in  |
| 输出文件名   | magic.out | blackhole.out | task.out | game.out |
| 时间限制     | 1.5秒     | 1.0秒         | 1秒      | 2.0秒    |
| 空间限制     | 512MB     | 512MB         | 512MB    | 512MB    |
| 测试点数目   | 10        | 10            | 10       | 10       |
| 测试点分值   | 10        | 10            | 10       | 10       |
| 题目类型     | 传统      | 传统          | 传统     | 传统     |
| 比较方式     | 全文比较  | 全文比较      | 全文比较 | 全文比较 |
| 是否有部分分 | 是        | 是            | 是       | 是       |

二、注意事项：

1.文件名（程序名和输入输出文件名）必须使用小写。

2.C/C++中函数main()的返回值类型必须是int，程序正常结束时的返回值必须是0。

3.评测环境为Linux，使用lemonlime进行评测。

4.选手不得使用SSH等命令。

5.选手不得使用内嵌汇编，#pragma等指令。

6.评测时使用 C++14 环境，同时开启 O2 优化，栈空间和内存限制相同。



# 大魔法师(magic)

### 【题目描述】

小明是一个魔法师，可以通过魔法加强他手下的战斗力。

他有$n$个手下，第$i$个手下战斗力为$a_i $。

他准备和朋友小强玩一把沙盘游戏，作为魔法师，他可以使用$20$点蓝量将手下的战斗力强化，假设原来的战斗力为$x$，那么强化后的战斗力为$x^2+1$,由于强化也具有抗性，所以每个手下只会增强一次。

现在他初始蓝条为$m$，他需要先选择若干个手下，组成一个战斗小分队，再对战斗小分队中的若干个进行一次强化，请你求出使得战斗小分队的战斗力和为$k$的方案数（选择手下不同或者强化对象不同视为不同方案）。

### 【输入格式】

第一行三个整数$n,m,k$

第二行$n$个整数$a_i $

### 【输出格式】

输出一个整数，表示方案

### 【样例 $1$ 输入】

```
2 40 5
2 2
```

### 【样例 $1$ 输出】

```
2
```

### 【样例 $2$】

见下发文件

### 【样例 $3$】

见下发文件

### 【子任务】

对于$60\%$的数据，$1\le n\le 10$

对于$100\%$的数据，$1\le n\le 24,0\le m\le 500,0\le a_i,k\le 10^9$

# 黑洞 (blackhole)

### 【题目描述】

小明有一个有 $n$ 行 $m$ 列的棋盘，一共有 $n\times m$ 个棋盘格子。

有一天他的棋盘被黑客入侵了，造出了一个黑洞，位于棋盘的第 $x$ 行，第 $y $ 列，而其他格子都是正常的，而每个格子上都放有一颗棋子。小明想到了一个有趣的游戏，他可以通过倾斜棋盘使得棋子发生一模一样的位移。具体来说，小明可以通过倾斜棋盘，使得棋盘上所有棋子同时往上下左右位移一个格子。

举个例子，当前棋子位于 $(i,j)$ ，小明设计了倾斜棋盘的按钮。

1. 按钮 `U`：它将移动到 $(i − 1, j)$
2. 按钮 `D`：它将移动到 $(i + 1, j)$
3. 按钮 `L`：它将移动到  $(i, j − 1)$
4. 按钮 `R`：它将移动到  $(i, j + 1) $

如果一颗棋子掉进黑洞里或掉出棋盘，那么该棋子将离开棋盘不再回来。 

但黑洞的确切位置不知道。

小明想知道，当他确定了之后的只包含字符`U`,`D`,`L`,`R`的操作序列，有多少黑洞满足经过上述操作序列后棋盘上剩余棋子数量为 $k$。

### 【输入格式】

输入包含多个数据。

第一行包含一个整数 $ T$，表示数据组数。

对于每组数据， 第一行包含三个整数 $n,m,k$。

 第二行包含一个字符串 $s_1s_2 · · · s_l（s_i ∈ \{'U', 'D', 'L', 'R'\}）$。 

### 【输出格式】

对于每个测试用例，输出一个整数。

###  【样例 $1$ 输入】

```
2
5 5 3
ULDDRR
5 5 10
UUUUUUU
```

### 【样例 $1$ 输出】

```
1
0
```

### 【样例 $2$】

见下发文件

### 【样例 $3$】

见下发文件

### 【子任务】

令$n$表示字符串长度

对于$30\%$的数据，$1\le n,m,l\le 10$。

对于$60\%$的数据，$1\le n,m,l\le 100$

对于$100\%$的数据，$T\le 10,1\le n,m\le 1000,1\le l\le 10^5，0\le k\le nm$。

# 任务安排 (task)

### 【题目描述】

​	小明有 $n$ 项任务要做，每项任务有一个截止时间(ddl) $a_i $

​	小明有强迫症，他希望他所有任务可以按照他预期完成的时间顺序排列。小明是一个卷怪，但以小明的能力每天只能完成一项任务，他希望在前$n$天做完这$n$项任务，所以实际上任务完成时间是一个$1\sim n$的排列。小明同时非常看重绩点，他希望每项任务都在截止时间前完成。

​	小明得到了所有任务的ddl后将其记在了软件上，接下来小明会安排合法的任务完成时间，并将任务按照完成时间$p_i$从小到大排序。而软件并没有排序功能，需要小明手动调整。小明每次可以交换相邻两项任务，作为懒惰的人，小明每次交换都会选择不合法的相邻两项，即$p_i>p_{i+1}$，将其变得顺眼。小明相信这样交换最轻松。现在小明想知道，所有合法任务完成时间序列的期望交换次数，如果实在太多小明将升级自己的设备。

​	保证一定存在合法的任务安排序列。

​	小明是个神人，他能通过模$998244353$的意义下的值得到精确的期望交换的次数。

​	注：在概率论和统计学中，数学期望(mathematic expectation)（或均值，亦简称期望）是试验中每次可能结果的概率乘以其结果的总和，是最基本的数学特征之一。它反映随机变量平均取值的大小。例如：某城市有 $10$ 万个家庭，没有孩子的家庭有 $1000$ 个，有一个孩子的家庭有 $9$ 万个，有两个孩子的家庭有 $6000$个，有$3$个孩子的家庭有$3000$个。则此城市中任一个家庭中孩子的数目是一个随机变量，记为$X$。它可取值$0，1，2，3$。其中，$X$取$0$的概率为$0.01$，取$1$的概率为$0.9$，取$2$的概率为$0.06$，取$3$的概率为$0.03$。则，它的数学期望$E(X)=0 \times 0.01 + 1 \times 0.9 + 2 \times 0.06 + 3 \times 0.03=1.11$，即此城市一个家庭平均有小孩$1.11$个

### 【输入格式】

第一行一个整数$n$，表示数列长度。

第二行$n$个整数表示数列$a_i$

### 【输出格式】

一个整数，对$998244353$取模

### 【样例 $1$ 输入】

```
6
4 2 5 1 6 3
```

### 【样例 $1$ 输出】

```
7
```

### 【样例 $2$ 输入】

```
3
2 3 3
```

### 【样例 $2$ 输出】

```
1
```

### 【样例 $3$ 】

见下发文件

### 【数据范围】

对于$20\%$的数据，$1\le n\le  6$。

对于$50\%$的数据，$1\le n\le 200$.

对于$70\%$的数据，$1\le n\le 1000$.

对于另外$10\%$的数据，$a_i$也是一个$1\sim n$排列。

对于$100\%$的数据，$1\le n\le 2\times 10^5,1\le a_i\le 10^6$。

# 游乐园 (game)

### 【题目描述】

小明来到了一个游乐园，里面有$n$个项目，每个项目都有一个等第，用大写字母`A`,`B`,`c`,`D`...来表示。

每个项目等第有一个上限$m_i$，即该项目获得的等第只能介于`A`和第$m_i$个大写字母之间。

依次游玩了$n$个项目后，小明就可以得到一个长度为$n$的等第字符串。

而每天游乐园都会公布一个长度为$n$的幸运字符串，当小明的等第字符串和幸运字符串的最长公共子序列长度大于等于$n-2$时，小明将获得幸运大奖。

小明通过一些途径提前得知了今日的幸运字符串，他想知道一共有多少种字符串可以帮他获得幸运大奖。

### 【输入格式】

第一行一个整数 $n$，表示字符串的长度

第二行 $n$ 个整数，表示能获得的等第的上限

第二行一个字符串$s$

### 【输出格式】

一个整数表示答案，对998244353取模

### 【样例 $1$ 输入】

```
3
3 3 2
AAB
```

### 【样例 $1$ 输出】

```
18
```

### 【样例 $2$】

见下发文件

### 【样例 $3$】

见下发文件

### 【数据范围】

对于$20\%$的数据，$1\le n\le 4$。

对于$80\%$的数据，$1\le n\le 10^4$

对于$100\%$的数据，$1\le n\le 10^5,1\le m_i\le 26$，$s_i\in A\sim Z$。