# OIFHA 联考

| 题目名称       | 小鸭子取石子 | 小鸭子魔法阵 | 小鸭子当岛主 | 小鸭子      |
| -------------- | ------------ | ------------ | ------------ | ----------- |
| 题目类型       | 传统型       | 传统型       | 传统型       | 传统型      |
| 可执行文件名   | stone.exe    | magic.exe    | island.exe   | genshin.exe  |
| 输入文件名     | stone.in     | magic.in     | island.in    | genshin.in  |
| 输出文件名     | stone.out    | magic.out    | island.out   | genshin.out |
| 每个测试点时限 | 1.0 秒       | 2.5 秒       | 2 秒         | 2.0秒       |
| 内存限制       | 512 MiB      | 512 MiB      | 512 MiB      | 512 MiB     |
| 测试点数目     | 20           | 20           | 20           | 20          |
| 测试点是否等分 | 是           | 是           | 是           | 是          |

# 小鸭子取石子（stone）

## 题目大意

邓达克 和 BaoBao 是好朋友。

一天，他们两个为了谁是最帅的人起了争执，于是他们决定依靠决斗来判断谁是最帅的人。

因为他们认为最帅的人智商要高，于是决定用一个益智游戏来决出胜负。

然后他们从附近的草丛中捡了一些石子，他们将石头分成 $n$ 堆（$n$ 为偶数），每一堆有 $a_i$ 个石子，他们轮流取石子，每次一个人选取 $\frac{n}{2}$ 堆，每一堆取一些石子（每一堆都要至少取一个石子，每一堆取得石子数可以不同），如果谁先不能取（即有石子的堆数小于 $\frac{n}{2}$）的时候就输了。

由于是 邓达克 先取，并且也是他来分石头，所以他想问在一种分法下他是否必胜？

## 输入格式

第一行一个整数 $T$，代表有 $T$ 组数据。

对于每一组数据，第一行一个正整数 $n$，代表有 $n$ 堆石子。

接下来一行 $n$ 个正整数 $a_i$，表示第 $i$ 堆有 $a_i$ 个石子。

## 输出格式

有 $T$ 行，第 $i$ 行如果 邓达克 必胜就输出 `DK`，否则输出 `BaoBao`。

### 样例输入 1

```
2
2
5 7
4
5 5 5 5
```

### 样例输出 1

```
DK
BaoBao
```

## 数据范围

| 数据点编号 | $n\leq$       | $a_i\leq$        | $T\leq$        | 特殊性质 |
| --------- | -------------- | -------------- | -------------- | -------- |
| $1$   | $2$         | $10^9$         | $10$        | 无 |
| $2\sim6$   | $6$         | $10$         | $10$       | 无 |
| $7\sim 10$        | $10^5$ | $10^9$ | $10$        | A |
| $11\sim20$        | $10^5$ | $10^9$ | $10$      | 无 |

特殊性质 A：保证所有 $a_i$ 只存在两种不同的数值

对于所有的数据，$2\leq n\leq 10^5,1\leq a_i\leq 10^9,T\leq 10$。

# 小鸭子魔法阵（magic）

## 题面描述

从前有一个神秘的小岛，住着许多嘎嘎直叫的小鸭子，叫做 DK 岛。

DK 岛有一个小鸭子魔法师，它很擅长魔法，它用魔法守护着神秘的 DK 岛，保护着小鸭子的安全。

有一天 DK 岛的岛主邓达克希望小鸭子魔法师可以送给他一些魔法宝石，来方便他管理岛屿。

小鸭子魔法师送给邓达克 $n$ 个魔法宝石，编号为 $1,2,\cdots,n$，其中 $i-1,i(i>1)$ 的宝石是相连的。

第 $i$ 颗宝石蕴含的神秘力量由五个属性来描述，用五个字符串表示：$\text{Jin}_i$， $\text{Mu}_i$，$\text{Shui}_i$， $\text{Huo}_i$，$\text{Tu}_i$，也就是金木水火土五种元素。

一颗宝石的力量值是五种元素的乘积，也就是 $\text{Jin}_i\times \text{Mu}_i\times \text{Shui}_i\times \text{Huo}_i\times \text{Tu}_i$。

选择一些魔法宝石可以组成魔法阵，魔法阵的力量就是魔法阵中宝石力量值的和。

邓达克为了岛上管理的需要，会时不时地要求修改一些宝石：

- `J l r x` 表示 $i\in[l,r]$ 范围内$\text{Jin}_i\gets \text{Jin}_i+x$ 。
- `M l r x` 表示 $i\in[l,r]$ 范围内$\text{Mu}_i\gets \text{Mu}_i+x$ 。
- `S l r x` 表示 $i\in[l,r]$ 范围内$\text{Shui}_i\gets \text{Shui}_i+x$ 。
- `H l r x` 表示 $i\in[l,r]$ 范围内$\text{Huo}_i\gets \text{Huo}_i+x$ 。
- `T l r x` 表示 $i\in[l,r]$ 范围内$\text{Tu}_i\gets \text{Tu}_i+x$ 。

同时也有一个查询操作：

- `Q l r` 表示邓达克选用 $i\in [l,r]$ 范围内的所有宝石组成魔法阵，他希望知道这个魔法阵的力量值，由于魔法值可能会很大，你只需要输出答案模 $998244353$ 的值。

注意 $\gets$ 符号是赋值，修改的含义。

邓达克希望聪明的你帮忙解决这个问题，如果你完成的好，那么 DK 岛可能会给你一些土特产。

## 输入格式

第一行一个正整数 $n$。

接下来的 $n$ 行，其中的第 $i$ 行描述第 $i$ 个宝石，每行 $5$ 个整数，分别为$\text{Jin}_i$，$\text{Mu}_i$，$\text{Shui}_i$， $\text{Huo}_i$，$\text{Tu}_i$。

接下来的一行，一个整数 $Q$ 表示操作数。

接下来有 $Q$ 行，包含一个字母，字母只会是 `J`，`M`，`S`，`H`，`T`，`Q` 的一个，表示当前是什么操作，然后两个整数 $l$，$r$，除了操作 `Q`，其他操作还会输入一个整数 $x$。

含义参考题目描述

## 输出格式

对于每个的 `Q` 操作输出一行，包含一个整数表示答案。

## 样例

### 样例输入 1

```
5
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1
1 1 1 1 1
5
H 1 5 9
T 1 4 2
T 1 3 6
M 1 1 3
Q 1 2
```

### 样例输出 1

```
450
```

## 数据范围

对于所有的数据，满足 $1\leq n,q\leq 10^5,1\leq \text{Jin}_i, \text{Mu}_i, \text{Shui}_i, \text{Huo}_i, \text{Tu}_i,x\leq 998244352$ 。

| 数据点编号 | $n\leq$       | $q\leq$        | 特殊性质 |
| ---------- | -------------- | -------------- | -------- |
| $1\sim2$   | $2000$         | $2000$         | A        |
| $3\sim4$   | $2000$         | $2000$         | 无       |
| $5$        | $3\times 10^4$ | $3\times 10^4$ | A        |
| $6$        | $3\times 10^4$ | $3\times 10^4$ | B       |
| $7\sim12$  | $3\times 10^4$ | $3\times 10^4$ | C       |
| $13\sim14$ | $3\times 10^4$ | $3\times 10^4$ | 无       |
| $15\sim18$ | $10^5$ | $10^5$ | A      |
| $19\sim20$    | $10^5$ | $10^5$ | 无       |

特殊性质 A:保证所有$\text{Mu}_i$，$\text{Shui}_i$， $\text{Huo}_i$，$\text{Tu}_i$ 初始为 $1$，所有$\text{Mu}_i$，$\text{Shui}_i$， $\text{Huo}_i$，$\text{Tu}_i$  不会有修改操作。

特殊性质 B:保证所有$\text{Shui}_i$， $\text{Huo}_i$，$\text{Tu}_i$ 初始为 $1$，所有$\text{Mu}_i$，$\text{Shui}_i$， $\text{Huo}_i$，$\text{Tu}_i$ 不会有修改操作。

特殊性质 C:保证所有$\text{Shui}_i$， $\text{Huo}_i$，$\text{Tu}_i$ 初始为 $1$，所有 $\text{Shui}_i$， $\text{Huo}_i$，$\text{Tu}_i$ 不会有修改操作。



# 小鸭子当岛主（island）

## 题面描述

话说当年老鸭子要去世了，邓达克 来竞选 DK 岛岛主的继承人了！

比赛是一个在 DK 岛上由老鸭子举办的选拔继承人的比赛，作为经常 Fake 的神，邓达克 认为这场比赛它势在必得。~~但是选拔继承人好像并不依靠 Fake 。~~

老鸭子给出了一个函数 $\text{DK}(S,t)$，定义如下：

$$
\text{DK}(S,t) =
\left
\{
\begin{matrix}
\begin{aligned}
&\min \{a_i + \text{DK}(S - \{i\}, b_i + \max(t - a_i, 0))\} &S \not = \empty\\
&\ t &S = \empty\\
\end{aligned}
\end{matrix}
\right.
$$

其中 $S=\{1,2,3,4,\cdots,n\}$ 是集合，$S-\{i\}$ 代表 $S$ 集合除去 $i$ 后的集合。

现在老鸭子给出了一个全集 $S$ 和两个长度为 $n$ 的序列 $a$，$b$，并规定谁先求出 $\text{DK}(S,0)$ 谁就是继承人。

而你作为它的朋友，为了能帮助 邓达克 成为岛主，于是你打算帮助 邓达克。

其中 $a,b$ 均由构造参数生成。给定 $x_a,y_a,z_a$ 和 $a$ 的首项 $a_1$，对于 $i>1, a_i=(a_{i-1}\times x_a+y_a)\bmod z_a+1$。$b$ 的构造参数及构造方式同理。

## 输入格式

第一行一个正整数 $T$，表示数据的组数。

对于每组数据：

* 第一行一个正整数 $n$，表示序列的长度也是集合的元素个数；
* 第二行会给出 $4$ 个正整数 $a_1,x_a,y_a,z_a$；
* 第三行会给出 $4$ 个正整数 $b_1,x_b,y_b,z_b$。

## 输出格式

共 $T$ 行，每行一个整数，表示对应的答案。

## 样例

### 样例输入 1
```input1
2
3
3 2 4 5
2 1 1 3
5
7 3 1 7
2 3 2 5
```

### 样例输出 1
```output1
8
20
```

## 数据范围

|数据点编号|$n\leq$|构造参数|T|
|:-:|:-:|:-:|:-:|
|$1\sim 4$|$9$|$\leq 100$|$\leq 5$|
|$5\sim 8$|$1000$|$\leq 10^4$|$\leq 5$|
|$9\sim 16$|$3\times 10^5$|$\leq 10^7$|$\leq 5$|
|$17\sim 20$|$2\times 10^6$|$\leq 10^7$|$\leq 5$|



对于所有的数据，$n\leq 2\times 10^6$，构造参数小于 $10^7$。

# 小鸭子戒原神（genshin）

## 题目大意

最近，小鸭子们开始喜欢上了玩原神！

他们在玩原神的时候喜欢排成一排，我们从左到右给他们标号为 $1$ 到 $n$，第 $i$ 只小鸭子有一个沉迷度 $a_i$。

但是小鸭子的领导者 邓达克 不希望小鸭子们继续沉迷在原神中，所以他决定开讲座帮小鸭子们戒掉原神。

由于前面 $k$ 个人是 邓达克 的亲信，所以 邓达克 并不一定会帮他们戒原神，但是由于第 $k$ 个人是 邓达克 的兄弟，所以 邓达克 一定会帮他戒原神，也就是说邓达克每次会从编号为 $1$ 到 $k$ 中的一只小鸭子开始，到第 $n$ 只小鸭子结束，将他们分成任意多组，对于每一组开一个讲座帮他们戒原神。

由于 邓达克 觉得开太多场讲座太浪费自己的时间，于是它规定每场讲座至少有 $k$ 只小鸭子。

邓达克 每次开一场讲座都会有一个满意度，假设这一场讲座从第 $l$ 只小鸭子开始，第 $r$ 只小鸭子结束，则这一场讲座的满意度定义如下：

$$
(a_l\ \text{or} \ a_{l + 1}\ \text{or}\ \dots \text{or} \ a_{r}) + (a_l\ \text{and} \ a_{l + 1}\ \text{and}\ \dots \text{and} \ a_{r}) + \gcd(a_l,a_{l + 1},\dots,a_{r})
$$

邓达克 为他们亲信开讲座会有一个额外的满意度 $b_i$，表示从第 $i$ 个小鸭子开始的额外的满意度。

邓达克 想要满意度最大，作为他的大臣之一，你要帮他求出他所能达到的最大满意度。

## 输入格式

第一行，一个正整数 $T$，表示数据组数。

对于每一组数据：

第一行，两个正整数 $n,k$。

第二行，$n$ 个正整数 $a_1,a_2,a_3,\cdots,a_n$。

第三行，$k$ 个整数 $b_1,b_2,b_3,\cdots,b_k$。

## 输出格式

对于每一组数据，输出一行正整数表示答案。

## 样例

### 输入样例 1

```
1
6 2
3 1 4 5 6 2
6 -2
```

### 输出样例 1

```
31
```

## 数据范围

| 数据点编号  | $n\leq$        |
| ----------- | -------------- |
| $1\sim 2$   | $10$           |
| $3\sim 4$   | $3000$         |
| $5\sim 10$  | $3\times 10^4$ |
| $11\sim 20$ | $3\times 10^5$ |



对于所有的数据，$1\leq k<n\leq 3×10^5$，$T\leq 10$，$1\leq a_i\leq 2^{30},−2^{30}\leq b_i\leq 2^{30}$。
